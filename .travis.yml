language: python
python:
- '3.5'
addons:
  postgresql: '9.4'
install:
- pip install -r requirements.txt
cache:
  directories:
  - "$HOME/.cache/pip"
script:
- "./manage.py collectstatic --noinput -v 0"
- behave
- codeclimate-test-reporter
- bandit -r .
before_deploy:
- export PATH=$HOME:$PATH
- travis_retry curl -L -o $HOME/cf.tgz "https://cli.run.pivotal.io/stable?release=linux64-binary&version=6.15.0"
- tar xzvf $HOME/cf.tgz -C $HOME
- cf install-plugin autopilot -f -r CF-Community
deploy:
- provider: script
  script: "./bin/deploy staging"
  skip_cleanup: true
  on:
    branch: develop
env:
  global:
  - CF_USERNAME=f247a40a-0fa4-4482-a372-e2f6e3ce8e3e
  - CF_PASSWORD:
    - secure: "h4geUfGBPkWzITGoDU2EOGxqmh9tupm66xQtBELaIe6j/T//81HCOqA00nTs98xumbXE60wAjUEsryCx+ehmOQcJ+wq5nhdfMcVuftMwvvD/iL8dGHLlsGxXfszgp8RNGoplcZS4taQ9LTHu12JtHqBxdCIeatX2zoS4ItjqGOVOpaxqcmxO8Dl3wkeYiurO5TEjdoTMLCvgm5R3FS8VbAqQm2Rscou76jo6OrIZXeJliRmF30rDrwP92VBbIy6Bvq+gjPBEr8GTs0P55YvxXhjLF/cs4KJfPOLBj3MfGg1tIPM1DbgimXgEPADJfDaFypojsb9KqHxVq+ao+F8NaSxizp1iUA+Mtu5OEZcXsHDQlfLjpiaX4cT58D/Pt+q2YJLf1p0Y1P/nXWZ/rB39sMXCaq8v7re7S7V6gs0MDy6tVcKjsi2Yau7e4m+b3cxRfKe8hZSgDpwIyQEJ6QL/N/JBBCwPLvlYsQ7GJee6AffHYNKJg7B6RJS5lNLIKHuTwAKLwlPPKD+Fcbb+g+X9xcYW+5tiJZLa2qHnzdD0Xn9odTYJkkGtXB6MHV56DHyuYtXtk3vIWlhnfEfrfXJUfm49CYmeNxCopsgnIYf0D/GZ3Bi7znw0mSyKbqJRN5fOBN44jd5LNmCbTlj2+HApjZ5IQodj0Cpo4pc3AI2Ub8Q="
  - CODECLIMATE_REPO_TOKEN:
    - secure: "sM21iEMXCzK3EeRpStqUo9uqNovOT1TWihsz8fG+DNrH/f4Dq9R+jyUh8GyAeXHjLpSPTR6Tzl15Xd8rL49Avf2hv1M6KDYQcpM1e8/aCovUfkyS950cn8PIIGuI+OeyKI7yQvGpRL07IrbNvHlFyTPpDonjEz2umF0hMDflnj4JxxhHhNPEvJWg7r9z6vpuv7Yw6dO7iYO/XqLPVeGHx4oTg5oDvESOLIuruXhxqMLoPioHzWKbJg2Doo1SS5ZM3pePFVDDXHv84ZbzXNjnOuiGeLzvYV3uiy4p1VT26uBdQrFfnAOAzTUVWOh0tOHCEE4CvZXtC2/C2vWkE0M4ko27VRnPy8pCI/ZgyvwewVi1hx2NsklMfhLh6q30mxv8K4Wit3zmhM/eZ54S0vMkos6afMx5iVstqNmDIVOrkoFFkHV/Nuly6lliCdtx0pppTs3jUuERP41I7B6kX9mtutAAJho3P1nTeGWffEM6eG7yREW4TiO5nICmoOBrkR/8JkobBPbyfxbX3SdgcSkWpNCH80IIkUMCIVIMDtYWDWCP1VeKdYOtmU25v9E8XEftLuIPk9ZuZcakTDH6REUL70QpQIuXW9UbeKR+11qXMJWWAzf7dPKIFDGtsoV2E9j07brDkHMBWyeGicMK8dWwafMmAjLADNAy8PlM2BfMmok="
